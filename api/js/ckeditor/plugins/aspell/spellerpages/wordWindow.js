function wordWindow(){this._forms=[];this._getWordObject=_getWordObject;this._wordInputStr=_wordInputStr;this._adjustIndexes=_adjustIndexes;this._isWordChar=_isWordChar;this._lastPos=_lastPos;this.wordChar=/[a-zA-Z]/;this.windowType="wordWindow";this.originalSpellings=[];this.suggestions=[];this.checkWordBgColor="pink";this.normWordBgColor="white";this.text="";this.textInputs=[];this.indexes=[];this.resetForm=resetForm;this.totalMisspellings=totalMisspellings;this.totalWords=totalWords;this.totalPreviousWords=
totalPreviousWords;this.getTextVal=getTextVal;this.setFocus=setFocus;this.removeFocus=removeFocus;this.setText=setText;this.writeBody=writeBody;this.printForHtml=printForHtml}function resetForm(){if(this._forms)for(var a=0;a<this._forms.length;a++)this._forms[a].reset();return!0}function totalMisspellings(){for(var a=0,b=0;b<this.textInputs.length;b++)a+=this.totalWords(b);return a}function totalWords(a){return this.originalSpellings[a].length}
function totalPreviousWords(a,b){for(var c=0,d=0;d<=a;d++)for(var e=0;e<this.totalWords(d)&&(d!=a||e!=b);e++)c++;return c}function getTextVal(a,b){var c=this._getWordObject(a,b);if(c)return c.value}function setFocus(a,b){var c=this._getWordObject(a,b);c&&"text"==c.type&&(c.focus(),c.style.backgroundColor=this.checkWordBgColor)}function removeFocus(a,b){var c=this._getWordObject(a,b);c&&"text"==c.type&&(c.blur(),c.style.backgroundColor=this.normWordBgColor)}
function setText(a,b,c){var d=this._getWordObject(a,b),e,f;if(d){f=this.indexes[a][b];var g=d.value;e=this.textInputs[a].substring(0,f);f=this.textInputs[a].substring(f+g.length,this.textInputs[a].length);this.textInputs[a]=e+c+f;this._adjustIndexes(a,b,c.length-g.length);d.size=c.length;d.value=c;this.removeFocus(a,b)}}
function writeBody(){var a=window.document;a.open();for(var b=0;b<this.textInputs.length;b++){var c=0,d=0;a.writeln('\x3cform name\x3d"textInput'+b+'"\x3e');var e=this.textInputs[b];this.indexes[b]=[];if(e){var f=this.originalSpellings[b];if(!f)break;a.writeln('\x3cdiv class\x3d"plainText"\x3e');for(var g=0;g<f.length;g++){do{d=e.indexOf(f[g],c);c=d+f[g].length;if(-1==d)break;var h=e.charAt(d-1),k=e.charAt(c)}while(this._isWordChar(h)||this._isWordChar(k));this.indexes[b][g]=d;for(h=this._lastPos(b,
g);h<d;h++)a.write(this.printForHtml(e.charAt(h)));a.write(this._wordInputStr(f[g]));g==f.length-1&&a.write(printForHtml(e.substr(c)))}a.writeln("\x3c/div\x3e")}a.writeln("\x3c/form\x3e")}this._forms=a.forms;a.close()}function _lastPos(a,b){return 0<b?this.indexes[a][b-1]+this.originalSpellings[a][b-1].length:0}function printForHtml(a){return a}function _isWordChar(a){return-1==a.search(this.wordChar)?!1:!0}
function _getWordObject(a,b){return this._forms[a]&&this._forms[a].elements[b]?this._forms[a].elements[b]:null}function _wordInputStr(a){return a="\x3cinput readonly "+('class\x3d"blend" type\x3d"text" value\x3d"'+a+'" size\x3d"'+a.length+'"\x3e')}function _adjustIndexes(a,b,c){for(b+=1;b<this.originalSpellings[a].length;b++)this.indexes[a][b]+=c};